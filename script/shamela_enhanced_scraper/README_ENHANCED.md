# Shamela Enhanced Scraper - ุณูุฑุจุช ุงูุดุงููุฉ ุงููุญุณู

ุณูุฑุจุช ูุญุณู ูุฐูู ูุงุณุชุฎุฑุงุฌ ุงููุชุจ ูู ุงูููุชุจุฉ ุงูุดุงููุฉ (shamela.ws) ูุน ุงูุชูุงูู ุงููุงูู ูุน ูุดุฑูุน BMS_v1 Laravel.

## ๐ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

### โก ุงูุฃุฏุงุก ุงููุญุณู
- **ุทูุจุงุช ูุชูุงุฒูุฉ**: ุงุณุชุฎุฑุงุฌ ุนุฏุฉ ุตูุญุงุช ูู ููุณ ุงูููุช
- **ุณุฑุนุฉ ูุญุณูุฉ**: ุชูููู ุงูุชุฃุฎูุฑ ุจูู ุงูุทูุจุงุช ุฅูู 0.2 ุซุงููุฉ
- **ูุนุงูุฌุฉ ุฐููุฉ ููุฃุฎุทุงุก**: ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุงูุชููุงุฆูุฉ ูุน ุชุฃุฎูุฑ ูุชุฏุฑุฌ
- **ุงุณุชุฎุฏุงู aiohttp**: ููุชุจุฉ async ูุญุณูุฉ ููุทูุจุงุช

### ๐ ููู ูุงูู ูููููู
- **ุงูุฃุฌุฒุงุก ูุงููุฌูุฏุงุช**: ุงูุชุดุงู ุชููุงุฆู ููุฃุฌุฒุงุก ููุทุงูุงุช ุงูุตูุญุงุช
- **ุงูููุฑุณ ุงููุฑูู**: ุงุณุชุฎุฑุงุฌ ุงููุตูู ูุงูุฃุจูุงุจ ุจุดูู ูุฑูู
- **ุฑุจุท ุฐูู**: ุฑุจุท ุงูุตูุญุงุช ุจุงููุตูู ูุงูุฃุฌุฒุงุก ุงูููุงุณุจุฉ

### ๐ฏ ุงุณุชุฎุฑุงุฌ ุงูุจุทุงูุฉ ุงููุงููุฉ
- **ุจุทุงูุฉ ุงููุชุงุจ**: ุงุณุชุฎุฑุงุฌ ูุงูู ูุจุทุงูุฉ ุงููุชุงุจ ูุญูุธูุง ูู `description`
- **ุชุฑููู ุงููุทุจูุน**: ุงูุชุดุงู ุชููุงุฆู ูู "ุชุฑููู ุงููุชุงุจ ููุงูู ูููุทุจูุน"
- **ูุนูููุงุช ูููููุฉ**: ุงุณุชุฎุฑุงุฌ ุงููุคูู ูุงููุงุดุฑ ูุงูุทุจุนุฉ ุจุดูู ูููุตู

### ๐๏ธ ุชูุงูู ูุงูู ูุน Laravel
- **ููุงุฐุฌ ูุชูุงููุฉ**: ุฌููุน ุงูููุงุฐุฌ ูุชูุงููุฉ ูุน migrations Laravel
- **ุนูุงูุงุช ุฐููุฉ**: ุฑุจุท ุงููุคูููู ูุงููุงุดุฑูู ุชููุงุฆูุงู
- **ููุน ุงูุชูุฑุงุฑ**: ูุญุต ูุฌูุฏ ุงููุคูููู ูุงููุงุดุฑูู ูุจู ุงูุฅูุดุงุก

## ๐ ุงููุชุทูุจุงุช

```bash
pip install -r requirements_enhanced.txt
```

### ุงูููุชุจุงุช ุงููุทููุจุฉ:
- `aiohttp>=3.8.0` - ููุทูุจุงุช ุงููุชูุงุฒูุฉ
- `beautifulsoup4>=4.11.0` - ูุชุญููู HTML
- `mysql-connector-python>=8.0.0` - ููุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
- `lxml>=4.9.0` - ูุญูู HTML ุณุฑูุน

## ๐๏ธ ุทุฑู ุงูุงุณุชุฎุฏุงู

### 1. ุงูุชุดุบูู ุงูุชูุงุนูู (ุงูุฃุณูู)

```bash
python run_enhanced_scraper.py
```

ุณูุธูุฑ ูู ูุงุฆูุฉ ุชูุงุนููุฉ ูุน ุงูุฎูุงุฑุงุช ุงูุชุงููุฉ:
- ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุงุฎุชุจุงุฑ ุณุฑูุน (ูุชุงุจ ูุงุญุฏ ุจุฏูู ุญูุธ)
- ุงุณุชุฎุฑุงุฌ ูุชุงุจ ูุงุญุฏ ูุญูุธู
- ุงุณุชุฎุฑุงุฌ ุนุฏุฉ ูุชุจ

### 2. ุงุณุชุฎุฏุงู ูุจุงุดุฑ ูู Python

```python
import asyncio
from shamela_scraper_enhanced import scrape_book, scrape_multiple_books

# ุงุณุชุฎุฑุงุฌ ูุชุงุจ ูุงุญุฏ
async def extract_single():
    book = await scrape_book("30151", save_to_db=True)
    print(f"ุชู ุงุณุชุฎุฑุงุฌ: {book.title}")

# ุงุณุชุฎุฑุงุฌ ุนุฏุฉ ูุชุจ
async def extract_multiple():
    book_ids = ["30151", "12345", "67890"]
    books = await scrape_multiple_books(book_ids, save_to_db=True)
    print(f"ุชู ุงุณุชุฎุฑุงุฌ {len(books)} ูุชุงุจ")

# ุชุดุบูู
asyncio.run(extract_single())
```

### 3. ุณุทุฑ ุงูุฃูุงูุฑ

```bash
# ุงุณุชุฎุฑุงุฌ ูุชุงุจ ูุงุญุฏ
python shamela_scraper_enhanced.py 30151

# ุงุณุชุฎุฑุงุฌ ุนุฏุฉ ูุชุจ
python shamela_scraper_enhanced.py 30151 12345 67890

# ุจุฏูู ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
python shamela_scraper_enhanced.py 30151 --no-db

# ุญูุธ ูู ููู JSON
python shamela_scraper_enhanced.py 30151 --output-json book.json

# ุชุฎุตูุต ุนุฏุฏ ุงูุทูุจุงุช ุงููุชูุงุฒูุฉ
python shamela_scraper_enhanced.py 30151 --concurrent 10
```

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช

### ุฅุนุฏุงุฏุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
ููููู ุชุนุฏูู ุฅุนุฏุงุฏุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ููู `shamela_scraper_enhanced.py`:

```python
DB_CONFIG = {
    'host': 'srv1800.hstgr.io',
    'port': 3306,
    'user': 'u994369532_test',
    'password': 'Test20205',
    'database': 'u994369532_test',
    'charset': 'utf8mb4',
    'autocommit': False,
    'raise_on_warnings': True
}
```

### ุฅุนุฏุงุฏุงุช ุงูุฃุฏุงุก
```python
REQUEST_TIMEOUT = 15                    # ูููุฉ ุงูุทูุจ ุจุงูุซูุงูู
MAX_CONCURRENT_REQUESTS = 5             # ุนุฏุฏ ุงูุทูุจุงุช ุงููุชูุงุฒูุฉ
REQUEST_DELAY = 0.2                     # ุชุฃุฎูุฑ ุจูู ุงูุทูุจุงุช
MAX_RETRIES = 3                         # ุนุฏุฏ ุงููุญุงููุงุช ุนูุฏ ุงููุดู
RETRY_DELAY = 2                         # ุชุฃุฎูุฑ ุจูู ุงููุญุงููุงุช
```

## ๐ ูููู ุงูุจูุงูุงุช

### ุฌุฏูู ุงููุชุจ (books)
```sql
- id: ูุนุฑู ูุฑูุฏ
- title: ุนููุงู ุงููุชุงุจ
- description: ุจุทุงูุฉ ุงููุชุงุจ ูุงููุฉ
- slug: ุฑุงุจุท ุตุฏูู ูููุญุฑูุงุช
- pages_count: ุนุฏุฏ ุงูุตูุญุงุช
- volumes_count: ุนุฏุฏ ุงูุฃุฌุฒุงุก
- source_url: ุฑุงุจุท ุงููุตุฏุฑ
- publisher_id: ูุนุฑู ุงููุงุดุฑ
- edition: ุฑูู ุงูุทุจุนุฉ
- edition_DATA: ุจูุงูุงุช ุงูุทุจุนุฉ
```

### ุฌุฏูู ุงููุคูููู (authors)
```sql
- id: ูุนุฑู ูุฑูุฏ
- full_name: ุงูุงุณู ุงููุงูู
- biography: ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ
- madhhab: ุงููุฐูุจ
- birth_year: ุณูุฉ ุงููููุงุฏ
- death_year: ุณูุฉ ุงูููุงุฉ
```

### ุฌุฏูู ุงูุฃุฌุฒุงุก (volumes)
```sql
- id: ูุนุฑู ูุฑูุฏ
- book_id: ูุนุฑู ุงููุชุงุจ
- number: ุฑูู ุงูุฌุฒุก
- title: ุนููุงู ุงูุฌุฒุก
- page_start: ุตูุญุฉ ุงูุจุฏุงูุฉ
- page_end: ุตูุญุฉ ุงูููุงูุฉ
```

### ุฌุฏูู ุงููุตูู (chapters)
```sql
- id: ูุนุฑู ูุฑูุฏ
- book_id: ูุนุฑู ุงููุชุงุจ
- volume_id: ูุนุฑู ุงูุฌุฒุก
- title: ุนููุงู ุงููุตู
- parent_id: ูุนุฑู ุงููุตู ุงูุฃุจ
- page_start: ุตูุญุฉ ุงูุจุฏุงูุฉ
- page_end: ุตูุญุฉ ุงูููุงูุฉ
```

### ุฌุฏูู ุงูุตูุญุงุช (pages)
```sql
- id: ูุนุฑู ูุฑูุฏ
- book_id: ูุนุฑู ุงููุชุงุจ
- volume_id: ูุนุฑู ุงูุฌุฒุก
- chapter_id: ูุนุฑู ุงููุตู
- page_number: ุฑูู ุงูุตูุญุฉ
- content: ูุญุชูู ุงูุตูุญุฉ
```

## ๐ ูุซุงู ุนูู ุจุทุงูุฉ ุงููุชุงุจ

ุนูุฏ ุงุณุชุฎุฑุงุฌ ูุชุงุจุ ุณูุชู ุญูุธ ุจุทุงูุฉ ุงููุชุงุจ ูุงููุฉ ูู ุนููุฏ `description`:

```
ุงููุชุงุจ: ุจูุช ุงููุตูุฏ ูู ุดุฑุญ ูุชุงุจ ุงูุชูุญูุฏ
ุงููุคูู: ุฃุญูุฏ ุจู ุนุจุฏ ุงูุฑุญูู ุจู ุนุซูุงู ุงููุงุถู
ุงููุงุดุฑ: ุฏุงุฑ ุงุจู ุงูุฌูุฒู ูููุดุฑ ูุงูุชูุฒูุนุ ุงูุฑูุงุถ - ุงูุณุนูุฏูุฉ
ุงูุทุจุนุฉ: ุงูุฃูููุ ูกูคูคูฃ ูู
ุนุฏุฏ ุงูุฃุฌุฒุงุก: ูข (ูุชุณูุณูุฉ ุงูุชุฑููู)
[ุชุฑููู ุงููุชุงุจ ููุงูู ูููุทุจูุน]
ุตูุญุฉ ุงููุคูู: [ุฃุญูุฏ ุงููุงุถู]
```

## ๐จ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

ุงูุณูุฑุจุช ูุชุนุงูู ูุน ุงูุฃุฎุทุงุก ุงูุชุงููุฉ:
- **ุฃุฎุทุงุก ุงูุดุจูุฉ**: ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุงูุชููุงุฆูุฉ
- **ุตูุญุงุช ุบูุฑ ููุฌูุฏุฉ**: ุชุฎุทู ูุชุณุฌูู ุงูุฎุทุฃ
- **ุฃุฎุทุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช**: rollback ุชููุงุฆู
- **ุงููุทุงุน ุงูุงุชุตุงู**: ุฅุนุงุฏุฉ ุงูุงุชุตุงู ุงูุชููุงุฆู

## ๐ ููุงุฑูุฉ ุงูุฃุฏุงุก

| ุงูููุฒุฉ | ุงูุณูุฑุจุช ุงููุฏูู | ุงูุณูุฑุจุช ุงููุญุณู |
|--------|----------------|-----------------|
| ุงูุณุฑุนุฉ | ุจุทูุก (1 ุซุงููุฉ/ุทูุจ) | ุณุฑูุน (0.2 ุซุงููุฉ/ุทูุจ) |
| ุงูุทูุจุงุช ุงููุชูุงุฒูุฉ | ูุง | ูุนู (5 ุทูุจุงุช) |
| ููู ุงูุฃุฌุฒุงุก | ูุญุฏูุฏ | ูุงูู |
| ุงุณุชุฎุฑุงุฌ ุงูุจุทุงูุฉ | ุฌุฒุฆู | ูุงูู |
| ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก | ุฃุณุงุณูุฉ | ูุชูุฏูุฉ |
| ุงูุชูุงูู ูุน Laravel | ุฌุฒุฆู | ูุงูู |

## ๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฎุทุฃ ูู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
```bash
# ุชุญูู ูู ุฅุนุฏุงุฏุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
python run_enhanced_scraper.py
# ุงุฎุชุฑ ุงูุฎูุงุฑ 1: ุงุฎุชุจุงุฑ ุงูุงุชุตุงู
```

### ุจุทุก ูู ุงูุงุณุชุฎุฑุงุฌ
```bash
# ุฒูุงุฏุฉ ุนุฏุฏ ุงูุทูุจุงุช ุงููุชูุงุฒูุฉ
python shamela_scraper_enhanced.py 30151 --concurrent 10
```

### ุฃุฎุทุงุก ูู ุงูุตูุญุงุช
- ุงูุณูุฑุจุช ูุชุฎุทู ุงูุตูุญุงุช ุงูุชู ุชุญุชูู ุนูู ุฃุฎุทุงุก ุชููุงุฆูุงู
- ูุชู ุชุณุฌูู ุฌููุน ุงูุฃุฎุทุงุก ูู ููู `shamela_enhanced_scraper.log`

## ๐ ุงูุณุฌูุงุช

ูุชู ุญูุธ ุฌููุน ุงูุนูููุงุช ูู ููู `shamela_enhanced_scraper.log`:
- ูุนูููุงุช ุงูุชูุฏู
- ุงูุฃุฎุทุงุก ูุงูุชุญุฐูุฑุงุช
- ุฅุญุตุงุฆูุงุช ุงูุงุณุชุฎุฑุงุฌ
- ุฃููุงุช ุงูุนูููุงุช

## ๐ค ุงููุณุงููุฉ

ูุชุญุณูู ุงูุณูุฑุจุช:
1. ุงูุชุฑุญ ุชุญุณููุงุช ูู ุงูุฃุฏุงุก
2. ุฃุถู ุฏุนู ูููุงูุน ุฃุฎุฑู
3. ุญุณู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
4. ุฃุถู ุงุฎุชุจุงุฑุงุช ุชููุงุฆูุฉ

## ๐ ุงูุชุฑุฎูุต

ูุฐุง ุงูุณูุฑุจุช ูุทูุฑ ุฎุตูุตุงู ููุดุฑูุน BMS_v1 ููููู ุงุณุชุฎุฏุงูู ูุชุนุฏููู ุญุณุจ ุงูุญุงุฌุฉ.

---

**ููุงุญุธุฉ**: ูุฑุฌู ุงุณุชุฎุฏุงู ุงูุณูุฑุจุช ุจูุณุคูููุฉ ูุงุญุชุฑุงู ุฎูุงุฏู ุงูููุชุจุฉ ุงูุดุงููุฉ. ุงูุณูุฑุจุช ูุตูู ููููู ุณุฑูุนุงู ูููู ูุญุชุฑูุงู ููุฎุงุฏู.